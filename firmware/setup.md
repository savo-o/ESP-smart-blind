# Настройка проекта

В этом файле описан процесс прошивки устройства, подключения к WiFi и дальнейшей интеграции с Яндекс Алисой.

## Прошивка устройства

### ⚠️ Требования

- ESP32 с подключенными по схеме компонентами
- Компьютер или ноутбук
- Устройство с WiFi (телефон или планшет)
- USB-кабель с передачей данных

В проекте предусмотрено два официальных способа прошивки.

Рекомендуется использовать Web-Flasher, он стабильнее и не требует сложной настройки среды разработки.

## 1. Web-Flasher (рекомендуется)

### Первый способ:

### Требования

- Браузер Google Chrome или Microsoft Edge

1. Откройте в браузере: https://savo-o.github.io/firmware-esp-smart-blind

2. Нажмите CONNECT  
3. Выберите COM-порт вашей ESP32  
4. Нажмите INSTALL ESP SMART BLIND  
5. Подтвердите установку


### Второй способ (стабильнее):

### Требования

- Python 3.10 или новее
- Браузер Google Chrome или Microsoft Edge

### Запуск

1. На компьютере перейдите в папку: firmware/web-flasher

2. Откройте терминал в этой папке и выполните команду: python -m http.server

3. Откройте в браузере: http://localhost:8000

4. Нажмите CONNECT  
5. Выберите COM-порт вашей ESP32  
6. Нажмите INSTALL ESP SMART BLIND  
7. Подтвердите установку

Процесс прошивки может занять до 10 минут, это нормально.

После завершения ESP32 автоматически перезагрузится.

## 2. Ручная прошивка (Arduino IDE)

### Требования

- Arduino IDE
- Установленное ядро ESP32
- библиотека ESP32Servo

### Прошивка

1. Откройте файл:

firmware/code/ESPSmartBlind.ino

2. Выберите вашу плату (У меня подошла ESP32 Dev Module)
3. Выберите COM-порт  
4. Нажмите Upload  

## Подключение к WiFi

После первой загрузки ESP32 создает точку доступа:

ESP-SmartBlind-Setup

### Шаги

1. Подключитесь к этой сети с телефона или компьютера  
2. Откройте браузер  
3. Перейдите по адресу:

http://192.168.4.1

4. Заполните поля:

- WiFi SSID - имя вашей сети  
- WiFi пароль - пароль от сети  
- API-ключ - секретный ключ для управления устройством  

Важно:  
API-ключ необходимо сохранить, он изменяется только при полном сбросе устройства.

После сохранения настроек ESP32 автоматически подключится к WiFi.

Если подключение не удалось, повторите настройку.

## Получение локального IP

После успешной настройки ESP32, подключитесь к одному WiFi с платой, и перейдите по адресу: http://smartblind.local
Браузер выведет статус подключения, локальный IP адрес (важно запомнить его!), и саму ссылку для просмотра этого всего

## Проверка работы

После подключения ESP32 к сети выполните в браузере:

http://IP_ПЛАТЫ/open?key=ВАШ_API_КЛЮЧ

Если в ответе отображается: OPEN OK - устройство работает корректно. 
Можете завершить настройку проекта, или пойти дальше и сделать управление Алисой. Документация по ней лежит в папке firmware/alice.md

## Обновления

Для обновлений можете попробовать встроенный OTA updater (БЕТА)

Запуск: http://smartblind.local/update?key=КЛЮЧ
Скачать прошивку: https://savo-o.github.io/firmware-esp-smart-blind

Важно скачивать прошивку с припиской OTA, полную прошивку OTA-updater обновлять не может

Если надо полностью прошить устройство, используйте Web-Flasher. Он более эффекитивен

## Сброс настроек

Если вам надо сбросить настройки - нажмите на кнопку BOOT и держите ее до тех пор, пока сервопривод не дернется (обычно 6 секунд)

## Планы на будущее

- Создать сайт для обновлений
- Улучшить первую настройку
- Сделать настройку еще проще



